<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Agendar Cita</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script>
    async function cargarHoras() {
      const fecha = document.getElementById("fecha").value;
      const response = await fetch(`/citas/agendar?fecha=${fecha}`);
      const html = await response.text();
      document.open();
      document.write(html);
      document.close();
    }
  </script>
</head>
<body class="bg-light">
  <div class="container mt-5">
    <h1 class="text-center mb-4">üóìÔ∏è Agendar Cita</h1>

    <form method="POST" class="card p-4 shadow-sm">
      <div class="mb-3">
        <label class="form-label">Nombre completo</label>
        <input type="text" name="nombre" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">N√∫mero de c√©dula</label>
        <input type="text" name="cedula" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Correo electr√≥nico</label>
        <input type="email" name="correo" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Tipo de consulta</label>
        <select name="tipo" class="form-select" required>
          <option value="">Selecciona un tipo</option>
          <option value="General">Consulta general</option>
          <option value="Odontolog√≠a">Odontolog√≠a</option>
          <option value="Pediatr√≠a">Pediatr√≠a</option>
          <option value="Cardiolog√≠a">Cardiolog√≠a</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Selecciona fecha</label>
        <input type="date" id="fecha" class="form-control" onchange="cargarHoras()" required>
      </div>

      {% if horas %}
      <div class="mb-3">
        <label class="form-label">Hora disponible</label>
        <select name="fecha_cita" class="form-select" required>
          {% for h in horas %}
            <option value="{{ h.strftime('%Y-%m-%dT%H:%M') }}">
              {{ h.strftime('%H:%M') }}
            </option>
          {% endfor %}
        </select>
      </div>
      {% endif %}

      <div class="d-flex justify-content-center gap-3">
        <button type="submit" class="btn btn-success">Agendar cita</button>
        <a href="/" class="btn btn-secondary">Volver</a>
      </div>
    </form>
  </div>
</body>
</html>
